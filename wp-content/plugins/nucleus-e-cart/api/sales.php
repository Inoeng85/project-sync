<?phpglobal $request;$notincludeinvoice = $request->notIncludeInvoiceNumber;$request_for_sales = new StdClass();$arr_in_sales = explode(",",$notincludeinvoice);if(count($arr_in_sales) != 0){	$not_in_sales = "'".implode("','", $arr_in_sales)."'";	$qry_not_in_sales = " and a.invoice_number NOT IN ($not_in_sales)";}$qry_sales = mysql_query("SELECT * FROM wp_ecart_sales_order a, wp_ecart_sales_order_delivery_address b WHERE b.invoice_number=a.invoice_number $qry_not_in_sales");while($data_sales = mysql_fetch_array($qry_sales)){	$request_sales = new StdClass();	$request_sales->invoice_number = (string) $data_sales['invoice_number'];	$request_sales->customer_id = (string) $data_sales['customer_id'];	$request_sales->sale_date = (string) $data_sales['sale_date'];	$request_sales->delivery_contact_name = (string) $data_sales['delivery_contact_name'];	$request_sales->delivery_address_line1 = (string) $data_sales['delivery_address_line1'];	$request_sales->delivery_address_line2 = (string) $data_sales['delivery_address_line2'];	$request_sales->delivery_city = (string) $data_sales['delivery_city'];	$request_sales->delivery_state = (string) $data_sales['delivery_state'];	$request_sales->delivery_postcode = (string) $data_sales['delivery_postcode'];	$request_sales->delivery_country = (string) $data_sales['delivery_country'];	$qry_sales_detail = mysql_query("select * from wp_ecart_sales_order_detail a, wp_ecart_product b where a.invoice_number='".$data_sales['invoice_number']."' and b.product_id=a.product_id ");	while($data_sales_detail = mysql_fetch_array($qry_sales_detail))	{		$request_sales_detail = new StdClass();		$request_sales_detail->product_id = (string) $data_sales_detail['product_id'];		$request_sales_detail->product_code = (string) $data_sales_detail['product_code'];		$request_sales_detail->product_name = (string) trim($data_sales_detail['product_name']);		$request_sales_detail->quantity = (string) $data_sales_detail['quantity'];		$request_sales_detail->price_inc_tax = (string) $data_sales_detail['price_inc_tax'];		$request_sales_detail->price_exc_tax = (string) $data_sales_detail['price_exc_tax'];		$request_sales_detail->total_inc_tax = (string) $data_sales_detail['total_inc_tax'];		$request_sales_detail->total_exc_tax = (string) $data_sales_detail['total_exc_tax'];				$request_sales->item[] = $request_sales_detail;	}		$request_sales->customer = get_customer_detail($data_sales['customer_id']);		$request_for_sales->Sales[] = $request_sales;}function get_customer_detail($customer_id){	$qry = mysql_query("select * from wp_ecart_customer a, wp_ecart_customer_address b where b.customer_id=a.customer_id and a.customer_id='$customer_id'");	$data = mysql_fetch_array($qry);	$request_customer = new StdClass();	$request_customer->customer_id = (string) $data['customer_id'];	$request_customer->first_name = (string) $data['first_name'];	$request_customer->last_name = (string) $data['last_name'];	$request_customer->email = (string) $data['email'];	$request_customer->password = (string) $data['password'];	$request_customer->phone = (string) $data['phone'];	$request_customer->mobile_phone = (string) $data['mobile_phone'];	$request_customer->fax = (string) $data['fax'];	$request_customer->hear_about_us = (string) $data['hear_about_us'];	$request_customer->register_date = (string) $data['register_date'];	$request_customer->note = (string) $data['note'];	$request_customer->TokenCustomerID = (string) $data['TokenCustomerID'];	$request_customer->caverno = (string) $data['caverno'];	$request_customer->mailing_address_line1 = (string) $data['mailing_address_line1'];	$request_customer->mailing_address_line2 = (string) $data['mailing_address_line2'];	$request_customer->mailing_city = (string) $data['mailing_city'];	$request_customer->mailing_state = (string) $data['mailing_state'];	$request_customer->mailing_postcode = (string) $data['mailing_postcode'];	$request_customer->mailing_country = (string) $data['mailing_country'];	$request_customer->delivery_contact_name = (string) $data['delivery_contact_name'];	$request_customer->delivery_address_line1 = (string) $data['delivery_address_line1'];	$request_customer->delivery_address_line2 = (string) $data['delivery_address_line2'];	$request_customer->delivery_city = (string) $data['delivery_city'];	$request_customer->delivery_state = (string) $data['delivery_state'];	$request_customer->delivery_postcode = (string) $data['delivery_postcode'];	$request_customer->delivery_country = (string) $data['delivery_country'];	return $request_customer;}$xml = Parser::Obj2XML($request_for_sales);header('Content-type: text/xml');echo $xml;